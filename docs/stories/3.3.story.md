# Story 3.3: Create Assembler Config

## Status

Draft

## Story

**As a** developer,
**I want** to create an assembler configuration for my project,
**so that** I can define the traits and layers for my "Assembled" characters.

## Acceptance Criteria

1. A form allows me to create an Assembler Config with a `ticker` ID and define the layer `order`.
2. The creation process also requires a `treeConfig` to store the character traits.
3. Submitting the form uses the `createCreateAssemblerConfigTransaction` mutation.
4. The user signs the transaction and receives feedback on success or failure.

## Tasks / Subtasks

-   [ ] **Frontend:** Create the "Create Assembler Config" form/modal component.
    -   [ ] Add a text input for the `ticker` ID.
    -   [ ] Add an input for defining the layer `order` (e.g., a re-orderable list or a comma-separated text field).
    -   [ ] Add inputs for the `treeConfig` (e.g., a toggle for basic/advanced and a field for `numAssets`).
    -   [ ] Implement client-side validation for all fields.
-   [ ] **State Management:** Add state to manage the form inputs and submission status.
-   [ ] **Backend (BFF):** Create a new API endpoint `POST /api/projects/{projectId}/assembler-configs`.
    -   [ ] The endpoint should receive `ticker`, `order`, and `treeConfig` from the frontend.
    -   [ ] The handler should call the `createCreateAssemblerConfigTransaction` method from the Honeycomb API Client.
    -   [ ] The handler must return the serialized transaction to the frontend.
-   [ ] **Frontend:** Implement the form submission logic.
    -   [ ] On submit, send the form data to the new BFF endpoint.
    -   [ ] Receive the serialized transaction from the BFF.
    -   [ ] Prompt the user to sign the transaction via their connected wallet.
    -   [ ] Submit the signed transaction to the Honeycomb API.
    -   [ ] Display a success or error notification to the user based on the transaction result.
    -   [ ] On success, refresh the list of assembler configs.

## Dev Notes

-   **API Endpoint:** The frontend should call `POST /api/projects/{projectId}/assembler-configs`.
-   **Honeycomb Mutation:** The BFF will use the `createCreateAssemblerConfigTransaction` mutation from the `@honeycomb-protocol/edge-client`.
-   **Payload:** The mutation requires `project`, `authority`, `payer`, `treeConfig`, `ticker`, and `order`.
-   **`treeConfig`**: This object is used to create a new Merkle tree for storing the character traits associated with this assembler. It has two modes:
    -   `basic`: Requires just `numAssets` (the desired number of traits the tree can store).
    -   `advanced`: Requires `maxDepth`, `maxBufferSize`, and `canopyDepth`. The `basic` config is recommended for simplicity.
-   **Transaction Flow:** The core workflow is: Frontend (Form) → BFF (API Endpoint) → Honeycomb API (Transaction Creation) → BFF → Frontend (Signing) → Honeycomb API (Transaction Execution).

## Testing

-   **Unit Test (Frontend):** Verify the "Create Assembler Config" form renders correctly and that validation works as expected.
-   **Unit Test (Backend):** Verify the BFF endpoint correctly calls the `createCreateAssemblerConfigTransaction` mutation with the right parameters.
-   **Integration Test:** Test the full flow from form submission to transaction signing and confirmation.
-   **Validation:** Confirm that after a successful transaction, a new Assembler Config is visible in the project's asset list.
-   **Error Handling:** Test what happens if the wallet transaction is rejected by the user. Test what happens if the Honeycomb API returns an error.

## Change Log

| Date | Version | Description | Author |
| :--- | :--- | :--- | :--- |
| 2025-07-24 | 1.0 | Initial draft | SM |